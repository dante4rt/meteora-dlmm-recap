---
import { getCollection } from 'astro:content';
import DocsLayout from '../layouts/DocsLayout.astro';
import { getTranslations } from '../i18n/utils';

const locale = 'en';
const t = getTranslations(locale);

const notes = await getCollection('notes');
// Filter by English language
const filtered = notes.filter((entry) => entry.data.lang === 'en');
const sorted = filtered.sort((a, b) => (a.data.day ?? 0) - (b.data.day ?? 0));
---

<DocsLayout title={t.site.title} locale={locale}>
  <h1>{t.site.title}</h1>
  <p>{t.site.description}</p>

  <div class="day-grid">
    {sorted.map((entry) => {
      // Remove language suffix from slug (e.g., "day-1-en" -> "day-1")
      const slug = entry.id.replace(/-(en|id)$/, '');
      return (
        <a href={`/${slug}/`} class="day-card">
          <h2>{entry.data.title}</h2>
          {entry.data.description && <p>{entry.data.description}</p>}
          {entry.data.date && (
            <time datetime={entry.data.date.toISOString()}>
              {entry.data.date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
              })}
            </time>
          )}
        </a>
      );
    })}
  </div>
</DocsLayout>

<style>
  .day-grid {
    display: grid;
    gap: 12px;
    margin-top: 16px;
  }

  /* Tablet: Increase gap */
  @media (min-width: 480px) {
    .day-grid {
      gap: 16px;
      margin-top: 24px;
    }
  }

  .day-card {
    display: block;
    padding: 14px 16px;
    border: 1px solid var(--spectrum-gray-200);
    border-radius: 8px;
    text-decoration: none;
    transition: border-color 0.15s ease, box-shadow 0.15s ease;
  }

  /* Tablet: Better padding */
  @media (min-width: 480px) {
    .day-card {
      padding: 18px 20px;
    }
  }

  /* Desktop: Full padding */
  @media (min-width: 1024px) {
    .day-card {
      padding: 20px 24px;
    }
  }

  .day-card:hover {
    border-color: var(--spectrum-accent-color-900, var(--spectrum-blue-800));
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
  }

  .day-card h2 {
    margin: 0;
    font-size: clamp(17px, 3.5vw, 20px);
    color: var(--spectrum-gray-900);
  }

  .day-card p {
    margin: 6px 0 0;
    font-size: var(--docs-font-size-xs);
    color: var(--spectrum-gray-700);
  }

  /* Tablet: Better spacing */
  @media (min-width: 480px) {
    .day-card p {
      margin-top: 8px;
      font-size: var(--docs-font-size-sm);
    }
  }

  .day-card time {
    display: block;
    margin-top: 6px;
    font-size: var(--docs-font-size-xs);
    color: var(--spectrum-gray-600);
  }

  /* Tablet: Better spacing */
  @media (min-width: 480px) {
    .day-card time {
      margin-top: 8px;
    }
  }

  /* Dark theme adjustments */
  :global(.spectrum--darkest) .day-card {
    border-color: var(--spectrum-gray-700);
  }

  :global(.spectrum--darkest) .day-card:hover {
    border-color: var(--spectrum-accent-color-500, #5dadec);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  }

  :global(.spectrum--darkest) .day-card h2 {
    color: var(--spectrum-gray-50);
  }

  :global(.spectrum--darkest) .day-card p {
    color: var(--spectrum-gray-300);
  }

  :global(.spectrum--darkest) .day-card time {
    color: var(--spectrum-gray-400);
  }
</style>
